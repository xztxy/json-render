export const metadata = { title: "Data Binding" }

# Data Binding

Connect UI elements to dynamic data using expressions in your JSON specs.

## State Model

Every spec can include a `state` object that holds the data your UI reads from:

```json
{
  "root": "greeting",
  "elements": {
    "greeting": {
      "type": "Text",
      "props": { "content": { "$state": "/user/name" } },
      "children": []
    }
  },
  "state": {
    "user": { "name": "Alice" }
  }
}
```

State can also be provided programmatically via `StateProvider` in React or React Native. See the [React API reference](/docs/api/react#useStateStore) for hooks like `useStateStore`, `useStateValue`, and `useStateBinding`.

## JSON Pointer Paths

All paths in json-render follow JSON Pointer (RFC 6901). A path is a string of `/`-separated tokens starting from the root:

```
Given this state:
{
  "user": { "name": "Alice", "email": "alice@example.com" },
  "todos": [
    { "title": "Buy milk", "done": false },
    { "title": "Walk dog", "done": true }
  ]
}

"/user/name"      -> "Alice"
"/user/email"     -> "alice@example.com"
"/todos/0/title"  -> "Buy milk"
"/todos/1/done"   -> true
```

## Expressions

Expressions are special objects you place in props to read dynamic values instead of hardcoding them. There are three expression types.

### `$state` -- Read from state

Use `{ "$state": "/path" }` in any prop to read a value from the state model:

```json
{
  "type": "Card",
  "props": {
    "title": { "$state": "/user/name" },
    "subtitle": { "$state": "/user/email" }
  },
  "children": []
}
```

If state contains `{ "user": { "name": "Alice", "email": "alice@example.com" } }`, the Card renders with title "Alice" and subtitle "alice@example.com".

### `$item` -- Read from the current repeat item

Use `{ "$item": "/field" }` inside a [repeat](#repeat) to read a field from the current array item:

```json
{
  "type": "Text",
  "props": { "content": { "$item": "/title" } },
  "children": []
}
```

Use `{ "$item": "/" }` to get the entire item object.

### `$index` -- Current repeat index

Use `{ "$index": true }` inside a [repeat](#repeat) to get the current array index (zero-based number):

```json
{
  "type": "Text",
  "props": { "content": { "$index": true } },
  "children": []
}
```

## Repeat

The `repeat` field on an element renders its children once per item in a state array. It is a top-level field on the element, sibling of `type`, `props`, and `children` -- not inside `props`.

```json
{
  "root": "todo-list",
  "elements": {
    "todo-list": {
      "type": "Column",
      "props": { "gap": 8 },
      "repeat": { "path": "/todos", "key": "id" },
      "children": ["todo-item"]
    },
    "todo-item": {
      "type": "Card",
      "props": {
        "title": { "$item": "/title" },
        "subtitle": { "$item": "/description" }
      },
      "children": []
    }
  },
  "state": {
    "todos": [
      { "id": "1", "title": "Buy milk", "description": "2% or whole" },
      { "id": "2", "title": "Walk dog", "description": "Around the park" }
    ]
  }
}
```

- `repeat.path` -- JSON Pointer to the state array
- `repeat.key` -- field name on each item to use as a stable React key

Inside `todo-item`, `{ "$item": "/title" }` reads the `title` field from whichever array item is currently being rendered. `{ "$index": true }` would return `0` for the first item, `1` for the second, and so on.

## Two-Way Binding with `statePath`

Form components like `TextInput`, `Switch`, and `Slider` accept a `statePath` prop for two-way binding. The component reads its value from that state path and writes updates back to it:

```json
{
  "type": "TextInput",
  "props": {
    "placeholder": "Enter your email",
    "statePath": "/form/email"
  },
  "children": []
}
```

Inside a repeat, prefix statePath with `$item` to bind to the current item:

```json
{
  "type": "Switch",
  "props": {
    "label": "Done",
    "statePath": "$item/done"
  },
  "children": []
}
```

## Conditional Props

Use `$cond` / `$then` / `$else` to pick a prop value based on a condition:

```json
{
  "type": "Badge",
  "props": {
    "label": {
      "$cond": { "$state": "/user/isAdmin" },
      "$then": "Admin",
      "$else": "Member"
    }
  },
  "children": []
}
```

The condition uses the same [visibility](/docs/visibility) expression format.

## Quick Reference

```
Expression   Syntax                                         Context
-----------  ---------------------------------------------  -------------------
$state       { "$state": "/path" }                          Anywhere
$item        { "$item": "/field" }                          Inside repeat only
$index       { "$index": true }                             Inside repeat only
$cond        { "$cond": ..., "$then": ..., "$else": ... }   Anywhere
statePath    "statePath": "/path"                           Form components
```

## Next

- [Visibility](/docs/visibility) -- conditionally show or hide elements
- [Action handlers](/docs/registry#action-handlers) -- respond to user interactions
- [React API reference](/docs/api/react) -- hooks for programmatic state access
